<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE concept PUBLIC "-//OASIS//DTD DITA Concept//EN" "concept.dtd">
<concept id="conceptId">
 <title id="x-1">Manager</title>
 <conbody id="x-2">
  <p id="x-3">The connection manager allows you to reuse connections. When making multiple queries to a
   single server (e.g., accessing Amazon S3), this can be critical for creating efficient code. A
   manager will keep track of multiple connections to a given server (taking into account port and
   SSL as well), automatically reaping unused connections as needed. When you make a request,
    <codeph id="x-4">http-conduit</codeph> first tries to check out an existing connection. When you're
   finished with the connection (if the server allows keep-alive), the connection is returned to the
   manager. If anything goes wrong, the connection is closed.</p>
  <p id="x-5">To keep our code exception-safe, we use the <codeph id="x-6">ResourceT</codeph> monad transformer. All
   this means for you is that your code needs to be wrapped inside a call to
    <codeph id="x-7">runResourceT</codeph>, either implicitly or explicitly, and that code inside that block
   will need to <codeph id="x-8">liftIO</codeph> to perform normal IO actions.</p>
  <p id="x-9">There are two ways you can get ahold of a manager. <codeph id="x-10">newManager</codeph> will return a
   manager that will not be automatically closed (you can use <codeph id="x-11">closeManager</codeph> to do so
   manually), while <codeph id="x-12">withManager</codeph> will start a new <codeph id="x-13">ResourceT</codeph> block,
   allow you to use the manager, and then automatically close the <codeph id="x-14">ResourceT</codeph> when
   you're done. If you want to use a <codeph id="x-15">ResourceT</codeph> for an entire application, and have
   no need to close it, you should probably use <codeph id="x-16">newManager</codeph>.</p>
  <p id="x-17">One other thing to point out: you obviously don't want to create a new manager for each and
   every request; that would defeat the whole purpose. You should create your
    <codeph id="x-18">Manager</codeph> early and then share it.</p>
 </conbody>
</concept>
